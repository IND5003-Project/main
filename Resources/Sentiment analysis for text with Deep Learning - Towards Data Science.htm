<!DOCTYPE html>
<!-- saved from url=(0090)https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5 -->
<html lang="en" data-rh="lang" class="gr__towardsdatascience_com"><link type="text/css" id="dark-mode" rel="stylesheet" href="https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5"><style type="text/css" id="dark-mode-custom-style"></style><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/branch-latest.min.js"></script><script async="" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/analytics.js"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title>Sentiment analysis for text with Deep Learning - Towards Data Science</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-04-05T13:27:16.890Z"><meta data-rh="true" name="title" content="Sentiment analysis for text with Deep Learning - Towards Data Science"><meta data-rh="true" property="og:title" content="Sentiment analysis for text with Deep Learning"><meta data-rh="true" property="twitter:title" content="Sentiment analysis for text with Deep Learning"><meta data-rh="true" name="twitter:site" content="@TDataScience"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2f0a0c6472b5"><meta data-rh="true" property="al:android:url" content="medium://p/2f0a0c6472b5"><meta data-rh="true" property="al:ios:url" content="medium://p/2f0a0c6472b5"><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236,app-argument=medium://p/2f0a0c6472b5"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="I started working on a NLP related project with twitter data and one of the project goals included sentiment classification for each tweet. However when I explored the available resources such as…"><meta data-rh="true" property="og:description" content="I started working on a NLP related project with  twitter data and one of the project goals included sentiment classification for each…"><meta data-rh="true" property="twitter:description" content="I started working on a NLP related project with  twitter data and one of the project goals included sentiment classification for each…"><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5"><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/600/0*33q1bTIm6jOzZXf_.png"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/600/0*33q1bTIm6jOzZXf_.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://towardsdatascience.com/@prajwalshreyas"><meta data-rh="true" name="author" content="Prajwal Shreyas"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="9 min read"><meta data-rh="true" name="parsely-post-id" content="2f0a0c6472b5"><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://towardsdatascience.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/m2.css"><link data-rh="true" rel="author" href="https://towardsdatascience.com/@prajwalshreyas"><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2f0a0c6472b5"><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F0*33q1bTIm6jOzZXf_.png"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fsentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5","dateCreated":"2019-04-02T05:50:59.476Z","datePublished":"2019-04-02T05:50:59.476Z","dateModified":"2019-04-05T13:27:17.104Z","headline":"Sentiment analysis for text with Deep Learning","name":"Sentiment analysis for text with Deep Learning","description":"I started working on a NLP related project with twitter data and one of the project goals included sentiment classification for each tweet. However when I explored the available resources such as…","identifier":"2f0a0c6472b5","keywords":["Lite:true","Tag:Machine Learning","Tag:Sentiment Analysis","Tag:Lstm","Tag:Deep Learning","Topic:Machine Learning","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC_UNENROLLED","LayerCake:3"],"author":{"@type":"Person","name":"Prajwal Shreyas","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@prajwalshreyas"},"creator":["Prajwal Shreyas"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":161,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F322\u002F1*5EUO1kUYBthpOCPzRj_l2g.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fsentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5"}</script><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><style type="text/css" data-fela-rehydration="415" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-moz-keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-webkit-keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-moz-keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-webkit-keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@-moz-keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@-webkit-keyframes k6{100%{stroke-dashoffset:50.24px}}@-moz-keyframes k6{100%{stroke-dashoffset:50.24px}}@keyframes k6{100%{stroke-dashoffset:50.24px}}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:fixed}.n{top:0}.o{left:0}.p{right:0}.q{z-index:500}.r{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.v{padding-left:24px}.w{padding-right:24px}.x{margin-left:auto}.y{margin-right:auto}.z{height:65px}.ab{width:100%}.ac{max-width:1080px}.ae{box-sizing:border-box}.af{display:flex}.ag{align-items:center}.aj{flex:1 0 auto}.ak{margin-left:-6px}.al{fill:rgba(0, 0, 0, 0.84)}.am{flex:0 0 auto}.an{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.ao{font-style:normal}.ap{line-height:20px}.aq{font-size:15.8px}.ar{letter-spacing:0px}.as{color:rgba(0, 0, 0, 0.54)}.at{fill:rgba(0, 0, 0, 0.54)}.au{justify-content:flex-end}.av{margin-top:16px}.aw{margin-bottom:16px}.ax{display:inherit}.ay{max-width:210px}.az{text-overflow:ellipsis}.ba{overflow:hidden}.bb{white-space:nowrap}.bc{display:inline-block}.bd{border:none}.be{outline:none}.bf{font:inherit}.bg{font-size:16px}.bh{opacity:0}.bi{position:relative}.bj{width:0px}.bk{transition:width 140ms ease-in}.bl{color:inherit}.bm{fill:inherit}.bn{font-size:inherit}.bo{border:inherit}.bp{font-family:inherit}.bq{letter-spacing:inherit}.br{font-weight:inherit}.bs{padding:0}.bt{margin:0}.bu:hover{cursor:pointer}.bv:hover{color:rgba(0, 0, 0, 0.9)}.bw:hover{fill:rgba(0, 0, 0, 0.9)}.bx:focus{outline:none}.by:disabled{cursor:default}.bz:disabled{color:rgba(0, 0, 0, 0.54)}.ca:disabled{fill:rgba(0, 0, 0, 0.54)}.cb{margin-left:16px}.cc{margin-right:10px}.cf{margin-right:16px}.cg{padding:4px 12px}.ch{color:rgba(0, 0, 0, 0.84)}.ci{background:0}.cj{border-color:rgba(0, 0, 0, 0.54)}.ck:hover{color:rgba(0, 0, 0, 0.97)}.cl:hover{fill:rgba(0, 0, 0, 0.97)}.cm:hover{border-color:rgba(0, 0, 0, 0.84)}.cn:disabled{fill:rgba(0, 0, 0, 0.76)}.co:disabled{border-color:rgba(0, 0, 0, 0.2)}.cp:disabled{cursor:inherit}.cq:disabled:hover{color:rgba(0, 0, 0, 0.54)}.cr:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.cs:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.ct{border-radius:4px}.cu{border-width:1px}.cv{border-style:solid}.cw{text-decoration:none}.cx{padding-bottom:10px}.cy{padding-top:10px}.cz{border-radius:50%}.da{height:32px}.db{width:32px}.dc{border-top:none}.dd{background-color:rgba(53, 88, 118, 1)}.df{height:54px}.dg{margin-right:40px}.dh{height:36px}.di{width:97px}.dj{overflow:auto}.dk{flex:0 1 auto}.dl{list-style-type:none}.dm{line-height:40px}.dn{overflow-x:auto}.do{align-items:flex-start}.dp{margin-top:20px}.dq{padding-top:20px}.dr{height:80px}.ds{height:20px}.dt{margin-right:15px}.du{margin-left:15px}.dv:first-child{margin-left:0}.dw{min-width:1px}.dx{background-color:rgba(197, 210, 225, 1)}.dy{font-weight:300}.dz{font-size:15px}.ea{color:rgba(197, 210, 225, 1)}.eb{text-transform:uppercase}.ec{letter-spacing:1px}.ed:hover{color:rgba(251, 255, 255, 1)}.ee:hover{fill:rgba(233, 241, 250, 1)}.ef:disabled{color:rgba(150, 171, 191, 1)}.eg:disabled{fill:rgba(150, 171, 191, 1)}.eh{margin-bottom:0px}.ei{height:119px}.el{max-width:728px}.em{flex-direction:column}.en{pointer-events:none}.eo{will-change:opacity}.ep{width:131px}.eq{left:50%}.er{transform:translateX(-516px)}.es{top:calc(65px + 54px + 40px)}.eu{padding-bottom:28px}.ev{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.ew{font-weight:600}.ex{font-size:18px}.ey{padding-bottom:20px}.ez{padding-top:2px}.fa{max-height:120px}.fb{display:-webkit-box}.fc{-webkit-line-clamp:6}.fd{-webkit-box-orient:vertical}.fe{color:rgba(90, 118, 144, 1)}.ff{fill:rgba(102, 138, 170, 1)}.fg{border-color:rgba(102, 138, 170, 1)}.fh:hover{color:rgba(84, 108, 131, 1)}.fi:hover{fill:rgba(90, 118, 144, 1)}.fj:hover{border-color:rgba(90, 118, 144, 1)}.fk{padding-top:28px}.fl{margin-bottom:19px}.fm{margin-left:-5px}.fn{margin-right:5px}.fo{outline:0}.fp{border:0}.fq{user-select:none}.fr{cursor:pointer}.fs> svg{pointer-events:none}.ft:active{border-style:none}.fu{-webkit-user-select:none}.fv:focus{fill:rgba(90, 118, 144, 1)}.fw{margin-top:5px}.fx button{text-align:left}.fy{fill:rgba(0, 0, 0, 0.76)}.fz{width:188px}.ga{transform:translateX(406px)}.gb{top:calc(65px + 54px + 14px)}.gd{margin-top:40px}.ge{clear:both}.gf{justify-content:center}.gl{max-width:680px}.gm{flex-wrap:wrap}.gn{margin-top:25px}.go{margin-right:8px}.gp{margin-bottom:8px}.gq{border-radius:3px}.gr{padding:5px 10px}.gs{background:rgba(0, 0, 0, 0.05)}.gt{line-height:22px}.gu{margin-top:15px}.gv{justify-content:space-between}.gw{border:1px solid rgba(0, 0, 0, 0.1)}.gx{height:60px}.gy{width:60px}.hl:active{border-style:solid}.hm{background:rgba(255, 255, 255, 1)}.hn{z-index:2}.ho{height:100%}.hp{position:absolute}.hr{padding-right:8px}.hs{display:none}.ht{padding-top:32px}.hu{border-top:1px solid rgba(0, 0, 0, 0.1)}.hv{margin-bottom:25px}.hw{margin-bottom:32px}.hx{min-height:80px}.ic{width:80px}.id{padding-left:102px}.if{letter-spacing:0.05em}.ig{margin-bottom:6px}.ih{font-size:28px}.ii{line-height:36px}.ij{max-width:555px}.ik{max-width:450px}.il{line-height:24px}.in{max-width:550px}.io{padding-top:25px}.ip{padding:20px}.iq{border:1px solid rgba(102, 138, 170, 1)}.ir{text-align:center}.is{margin-top:64px}.it{background-color:rgba(0, 0, 0, 0.02)}.iu{max-width:1032px}.iv{padding:60px 0}.iw{background-color:rgba(0, 0, 0, 0.9)}.jn{padding-bottom:48px}.jo{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.jp{margin:0 -12px}.jq{margin:0 12px}.jr{flex:1 1 0}.js{padding-bottom:12px}.jt:hover{color:rgba(255, 255, 255, 0.99)}.ju:hover{fill:rgba(255, 255, 255, 0.99)}.jv:disabled{color:rgba(255, 255, 255, 0.7)}.jw:disabled{fill:rgba(255, 255, 255, 0.7)}.jx{color:rgba(255, 255, 255, 0.98)}.jy{fill:rgba(255, 255, 255, 0.98)}.jz{text-align:inherit}.ka{font-size:21.6px}.kb{letter-spacing:-0.32px}.kc{color:rgba(255, 255, 255, 0.7)}.kd{fill:rgba(255, 255, 255, 0.7)}.ke{text-decoration:underline}.kf{padding-bottom:8px}.kg{padding-top:8px}.kh{width:200px}.kj:hover{text-decoration:underline}.kk{margin:15px 0}.kl{top:calc(100vh + 100px)}.km{bottom:calc(100vh + 100px)}.kn{width:10px}.ko{word-break:break-word}.kp{word-wrap:break-word}.kq:after{display:block}.kr:after{content:""}.ks:after{clear:both}.kt{margin:0 auto}.ku{line-height:1.23}.kv{letter-spacing:0}.kw{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.kx{font-size:40px}.ld{margin-bottom:-0.27em}.le{line-height:48px}.lf{margin-top:32px}.lg{height:48px}.lh{width:48px}.li{margin-left:12px}.lj{margin-bottom:2px}.ll{max-height:20px}.lm{-webkit-line-clamp:1}.ln{margin-left:8px}.lo{padding:0px 8px}.lp{line-height:18px}.lq{max-width:600px}.lw{transition:opacity 100ms 400ms}.lx{will-change:transform}.ly{transform:translateZ(0)}.lz{margin:auto}.ma{background-color:rgba(0, 0, 0, 0.05)}.mb{padding-bottom:94%}.mc{filter:blur(20px)}.md{transform:scale(1.1)}.me{visibility:visible}.mf{line-height:1.58}.mg{letter-spacing:-0.004em}.mh{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.ms{margin-bottom:-0.46em}.mt{background-repeat:repeat-x}.mu{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.mv{background-size:1px 1px}.mw{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.mx{font-weight:700}.my{line-height:1.18}.mz{letter-spacing:-0.022em}.nk{margin-bottom:-0.31em}.nq{font-style:italic}.nr{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.ns{margin-top:-0.09em}.nt{margin-bottom:-0.09em}.nu{white-space:pre-wrap}.oa{list-style-type:disc}.ob{margin-left:30px}.oc{padding-left:0px}.oi{max-width:1414px}.oj{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ok{cursor:zoom-in}.ol{z-index:auto}.om{padding-bottom:49.08062234794908%}.on{line-height:1.4}.oo{margin-top:10px}.or{max-width:2000px}.os{padding-bottom:26.25%}.ot{padding-bottom:37.55%}.ou{max-width:551px}.ov{padding-bottom:64.42831215970962%}.ow{max-width:769px}.ox{padding-bottom:9.752925877763328%}.oy{max-width:536px}.oz{padding-bottom:30.41044776119403%}.pa{-webkit-user-select:none}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.gk{margin:0 24px}.jk{padding-left:24px}.jl{padding-right:24px}.jm{max-width:1080px}.lc{margin-top:0.78em}.lv{margin-top:56px}.mq{font-size:21px}.mr{margin-top:2em}.ni{font-size:26px}.nj{margin-top:1.72em}.np{margin-top:0.86em}.nz{margin-top:1.91em}.oh{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.jh{padding-left:24px}.ji{padding-right:24px}.jj{max-width:1080px}.op{margin-left:auto}.oq{text-align:center}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.je{padding-left:24px}.jf{padding-right:24px}.jg{max-width:904px}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ah{height:56px}.ai{display:flex}.cd{margin-left:10px}.ce{margin-right:10px}.de{display:block}.ej{margin-bottom:0px}.ek{height:110px}.hy{margin-bottom:24px}.hz{align-items:center}.ia{width:102px}.ib{position:relative}.ie{padding-left:0}.im{margin-top:24px}.ix{padding:32px 0}.jb{padding-left:24px}.jc{padding-right:24px}.jd{max-width:728px}.ki{width:140px}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.gg{margin:0 24px}.iy{padding-left:24px}.iz{padding-right:24px}.ja{max-width:552px}.ky{margin-top:0.39em}.lk{margin-bottom:0px}.lr{margin-top:40px}.mi{font-size:18px}.mj{margin-top:1.56em}.na{font-size:24px}.nb{margin-top:1.23em}.nl{margin-top:0.67em}.nv{margin-top:1.41em}.od{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.gj{margin:0 24px}.lb{margin-top:0.78em}.lu{margin-top:56px}.mo{font-size:21px}.mp{margin-top:2em}.ng{font-size:26px}.nh{margin-top:1.72em}.no{margin-top:0.86em}.ny{margin-top:1.91em}.og{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.gi{margin:0 24px}.la{margin-top:0.78em}.lt{margin-top:56px}.mm{font-size:21px}.mn{margin-top:2em}.ne{font-size:26px}.nf{margin-top:1.72em}.nn{margin-top:0.86em}.nx{margin-top:1.91em}.of{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.gh{margin:0 24px}.kz{margin-top:0.39em}.ls{margin-top:40px}.mk{font-size:18px}.ml{margin-top:1.56em}.nc{font-size:24px}.nd{margin-top:1.23em}.nm{margin-top:0.67em}.nw{margin-top:1.41em}.oe{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="print">.u{display:none}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.s{transition:transform 300ms ease}.t{will-change:transform}.et{transition:opacity 200ms}.gz{transition:border-color 150ms ease}.ha::before{background:
      radial-gradient(circle, rgba(90, 118, 144, 1) 60%, transparent 70%)
    }.hb::before{border-radius:50%}.hc::before{content:""}.hd::before{display:block}.he::before{z-index:0}.hf::before{left:0}.hg::before{height:100%}.hh::before{position:absolute}.hi::before{top:0}.hj::before{width:100%}.hk:hover::before{animation:k2 2000ms infinite cubic-bezier(.1,.12,.25,1)}.hq{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="415" data-fela-type="RULE" media="all and (max-width: 1230px)">.gc{display:none}</style><script charset="utf-8" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/vendors_tracing.9f9c73c5.chunk.js"></script><script charset="utf-8" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/tracing.edc14c55.chunk.js"></script><link rel="icon" href="https://miro.medium.com/fit/c/256/256/1*F0LADxTtsKOgmPa-_7iUEQ.jpeg" data-rh="true"></head><body data-gr-c-s-loaded="true"><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="l m n o p c q r s t u" style=""><div class="branch-journeys-top"><div class="l c"><section class="v w x y z ab ac ae af ag ah ai"><div class="af ag aj q"><div class="ak l"><a href="https://medium.com/?source=post_page-----2f0a0c6472b5----------------------" aria-label="Homepage" rel="noopener"><svg width="45" height="45" viewBox="0 0 45 45" class="al"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a></div></div><div class="l am q"><span class="an b ao ap aq ar l as at"><div class="af ag au"><div class="bc"><div class="af"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25" class="cb cc l cd ce"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></button><input class="bd be bf bg ap bh bi bj bk" placeholder="Search Towards Data Science" value=""></div></div><div class="cf af ce"><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca l"><svg width="25" height="25" viewBox="-293 409 25 25" class="kk l"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></button></div></div><div class="cf l g"><div><a href="https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="cg ch al ci cj ck cl cm bu bz cn co cp cq cr cs ct an b ao ap aq ar cu cv ae bc cw bx" rel="noopener">Upgrade</a></div></div><div class="af"><div class="cx cy af ag"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><img alt="Abdullah AlBannay" class="l cz da db" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_b13lZgxJPD06oz0K.jpg" width="32" height="32"></button></div></div></div></span></div></section></div><div class="dc l dd de"><section class="v w x y df ab ac ae ba af ag"><div class="dg l am"><a href="https://towardsdatascience.com/?source=post_page-----2f0a0c6472b5----------------------" rel="noopener"><div class="dh di l"><img alt="Towards Data Science" class="" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_5EUO1kUYBthpOCPzRj_l2g.png" width="97" height="36"></div></a></div><div class="dj l dk"><ul class="dl bt dm bb dn af do g dp dq dr"><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/data-science/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Data Science</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/machine-learning/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Machine Learning</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/programming/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Programming</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/data-visualization/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Visualization</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/artificial-intelligence/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">AI</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/data-journalism/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Journalism</a></span></li><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener" href="https://towardsdatascience.com/toronto-machine-learning-summit-8bae371d4bb1?source=post_page-----2f0a0c6472b5----------------------">Events</a></span></li><span class="ds dw dx"></span><li class="af ag ds dt du dv"><span class="an dy dz ap ea eb ec"><a href="https://towardsdatascience.com/contribute/home?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu ed ee bx by ef eg" rel="noopener">Submit</a></span></li></ul></div></section></div></div></nav><div class="eh ei l ej ek"></div><article><section class="v w x y ab el ae af em"></section><span class="l"></span><div><div class="hp o kl km kn en"></div><section class="ko kp kq kr ks"><div class="ae kt ab el v w"><div><div id="27df" class="ku kv ch ao kw b kx ky kz la lb lc ld"><h1 class="kw b kx le ch">Sentiment analysis for text with Deep Learning</h1></div><div class="lf"><div class="ag af"><div><a href="https://towardsdatascience.com/@prajwalshreyas?source=post_page-----2f0a0c6472b5----------------------" rel="noopener"><img alt="Prajwal Shreyas" class="l cz lg lh" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_icUgBe3HTwAJt--svKBHfQ.jpeg" width="48" height="48"></a></div><div class="li ab l"><div class="af"><div style="flex:1"><span class="an b ao ap aq ar l ch al"><div class="lj af ag lk"><span class="an dy bg ap ba ll az fb lm fd ch"><a href="https://towardsdatascience.com/@prajwalshreyas?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Prajwal Shreyas</a></span><div class="ln l am h"><button class="lo ci fe ff fg fh fi fj bu ct an b ao lp dz ar cu cv ae bc cw bx">Follow</button></div></div></span></div></div><span class="an b ao ap aq ar l as at"><span class="an dy bg ap ba ll az fb lm fd as"><div><a class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener" href="https://towardsdatascience.com/sentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5?source=post_page-----2f0a0c6472b5----------------------">Apr 2</a> <!-- -->·<!-- --> <!-- -->9<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div></div><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="x y lq"><div class="lz l bi ma"><div class="mb l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_33q1bTIm6jOzZXf_.png" width="600" height="564" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="600" height="564" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_33q1bTIm6jOzZXf_(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/1200/0*33q1bTIm6jOzZXf_.png" width="600" height="564" role="presentation"/></noscript></div></div></div></figure><p id="30a9" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">I started working on a NLP related project with twitter data and one of the project goals included sentiment classification for each tweet. However when I explored the available resources such as NLTK sentiment classifier and other resource available in python, I was disappointed by the performance of these models. At most I would get about 60% to 70% accuracy on binary classification (i.e only positive or negative class) tasks.</p><p id="4709" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Hence I started researching about ways to increase my model performance. One of the obvious choices was to build a deep learning based sentiment classification model.</p><p id="b1d3" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">I am writing this blog post to share about my experience about steps to building a deep learning model for sentiment classification and I hope you find it useful. The link to the code repository can be found <a href="https://gitlab.com/praj88/deepsentiment" class="bl cw mt mu mv mw" target="_blank" rel="noopener">here</a>.</p><p id="b14d" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">I have designed the model to provide a sentiment score between 0 to 1 with 0 being very negative and 1 being very positive. This was done by building a multi-class classification model i.e 10 class, one class for each decile.</p><p id="59f3" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">There are <strong class="mh mx">5 major steps</strong> involved in the building a deep learning model for sentiment classification:</p><p id="3812" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step1:</strong> Get data.</p><p id="f542" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step 2: </strong>Generate embeddings</p><p id="3a1f" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step 3</strong>: Model architecture</p><p id="4840" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step 4</strong>: Model Parameters</p><p id="9c24" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step 5:</strong> Train and test the model</p><p id="f21d" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Step 6:</strong> Run the model</p><p id="2ab2" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">I am going to cover each of the above steps in detail below.</p><h2 id="24d3" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Step1: Get data</h2><p id="7c23" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">Sourcing the labelled data for training a deep learning model is one of the most difficult parts of building a model. Fortunately we can use the <a href="https://nlp.stanford.edu/sentiment/code.html" class="bl cw mt mu mv mw" target="_blank" rel="noopener">Stanford sentiment treebank data</a> for our purpose.</p><p id="9141" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The data set “dictionary.txt” consists of 239,233 lines of sentences with an index for each line. The index is used to match each of the sentences to a sentiment score in the file “labels.txt”. The score ranges from 0 to 1, 0 being very negative and 1 being very positive.</p><p id="5a09" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The below code reads the dictionary.txt and labels.txt files, combines the score to each sentences . This code is found within <strong class="mh mx"><em class="nq">train/utility_function.py</em></strong></p><pre class="lr ls lt lu lv ip gs dn"><span id="b233" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">def read_data(path):</span><span id="ab56" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># read dictionary into df</span><span id="cb7e" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentence = pd.read_table(path + ‘dictionary.txt’)</span><span id="1d13" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentence_processed = df_data_sentence[‘Phrase|Index’].str.split(‘|’, expand=True)</span><span id="6613" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentence_processed = df_data_sentence_processed.rename(columns={0: ‘Phrase’, 1: ‘phrase_ids’})</span><span id="e410" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># read sentiment labels into df</span><span id="5ae3" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentiment = pd.read_table(path + ‘sentiment_labels.txt’)</span><span id="de54" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentiment_processed = df_data_sentiment[‘phrase ids|sentiment values’].str.split(‘|’, expand=True)</span><span id="1333" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_data_sentiment_processed = df_data_sentiment_processed.rename(columns={0: ‘phrase_ids’, 1: ‘sentiment_values’})</span><span id="505d" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">#combine data frames containing sentence and sentiment</span><span id="a999" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">df_processed_all = df_data_sentence_processed.merge(df_data_sentiment_processed, how=’inner’, on=’phrase_ids’</span><span id="6e98" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">return df_processed_all</span></pre><p id="39e1" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The data is split into 3 parts:</p><ul class=""><li id="2e5d" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms oa ob oc" data-selectable-paragraph="">train.csv : This is the main data which is used to train the model. This is 50% of the overall data.</li><li id="3c8d" class="mf mg ch ao mh b mi od mk oe mm of mo og mq oh ms oa ob oc" data-selectable-paragraph="">val.csv : This is a validation data set to be used to ensure the model does not overfit. This is 25% of the overall data.</li><li id="805d" class="mf mg ch ao mh b mi od mk oe mm of mo og mq oh ms oa ob oc" data-selectable-paragraph="">test.csv : This is used to test the accuracy of the model post training. This is 25% of the overall data.</li></ul><h2 id="99fa" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Step 2: Generate embeddings</h2><p id="1c3d" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">Prior to training this model we are going to convert each of the words into a word embedding. You can think of word embeddings as numerical representation of words to enable our model to learn. For more details on word embeddings please read this <a href="https://www.datascience.com/resources/notebooks/word-embeddings-in-python" class="bl cw mt mu mv mw" target="_blank" rel="noopener">blog</a>.</p><p id="22b6" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><em class="nq">What are word embeddings?</em></p><p id="b5dd" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">They are vector representations that capture the context of the underlying words in relation to other words in the sentence. This transformation results in words having similar meaning being clustered closer together in the hyperplane and distinct words positioned further away in the hyperplane.</p><p id="f35a" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><em class="nq">How are we going to convert each word into a word embeddings?</em></p><p id="ed24" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">We are going to use a pre-trained word embedding model know as <a href="https://nlp.stanford.edu/projects/glove/" class="bl cw mt mu mv mw" target="_blank" rel="noopener">GloVe</a>. For our model we are going to represent each word using a 100 dimension embedding. The detailed code for converting the data into word embedding is in within <strong class="mh mx"><em class="nq">train/utility_function.py. </em></strong>This function basically replace each of the words by its respective embedding by performing a lookup from the GloVe pre-trained vectors. An illustration of the process is shown below, where each word is converted into an embedding and fed into a neural network.</p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="oj ok bi ol ab"><div class="x y oi"><div class="lz l bi ma"><div class="om l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_lNsgjlmv5FFVUxm7.png" width="1414" height="694" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="1414" height="694" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_lNsgjlmv5FFVUxm7(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/2828/0*lNsgjlmv5FFVUxm7.png" width="1414" height="694" role="presentation"/></noscript></div></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">Converting Sentences to Embedding for a Neural Network (<a href="https://www.datascience.com/resources/notebooks/word-embeddings-in-python" class="bl cw mt mu mv mw" target="_blank" rel="noopener">Source</a>)</figcaption></figure><p id="e6ec" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The below code is used to split the data into train, val and test sets. Also the corresponding embeddings for the data is stored in the weight_matrix variable.</p><pre class="lr ls lt lu lv ip gs dn"><span id="bd43" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">def load_data_all(data_dir, all_data_path,pred_path, gloveFile, first_run, load_all):</span><span id="0a64" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">   numClasses = 10</span><span id="29ae" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># Load embeddings for the filtered glove list<br>    if load_all == True:<br>        weight_matrix, word_idx = uf.load_embeddings(gloveFile)<br>    else:<br>        weight_matrix, word_idx = uf.load_embeddings(filtered_glove_path)</span><span id="a530" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">    # create test, validation and trainng data<br>    all_data = uf.read_data(all_data_path)<br>    train_data, test_data, dev_data = uf.training_data_split(all_data, 0.8, data_dir)</span><span id="8a99" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">train_data = train_data.reset_index()<br>    dev_data = dev_data.reset_index()<br>    test_data = test_data.reset_index()</span><span id="a1ae" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">    maxSeqLength, avg_words, sequence_length = uf.maxSeqLen(all_data)<br>  </span><span id="2955" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># load Training data matrix<br>    train_x = uf.tf_data_pipeline_nltk(train_data, word_idx, weight_matrix, maxSeqLength)<br>    test_x = uf.tf_data_pipeline_nltk(test_data, word_idx, weight_matrix, maxSeqLength)<br>    val_x = uf.tf_data_pipeline_nltk(dev_data, word_idx, weight_matrix, maxSeqLength)</span><span id="1101" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">    # load labels data matrix<br>    train_y = uf.labels_matrix(train_data)<br>    val_y = uf.labels_matrix(dev_data)<br>    test_y = uf.labels_matrix(test_data)</span><span id="a5c1" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">return train_x, train_y, test_x, test_y, val_x, val_y, weight_matrix</span></pre><h2 id="bd3f" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Step3: Model architecture</h2><p id="35df" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">In order to train the model we are going to use a type of Recurrent Neural Network, know as LSTM (Long Short Term Memory). The main advantage of this network is that it is able to remember the sequence of past data i.e. words in our case in order to make a decision on the sentiment of the word.</p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="oj ok bi ol ab"><div class="x y or"><div class="lz l bi ma"><div class="os l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_hkpZ3Ezkn7KINHKP.png" width="2000" height="525" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="2000" height="525" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_hkpZ3Ezkn7KINHKP(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/4000/0*hkpZ3Ezkn7KINHKP.png" width="2000" height="525" role="presentation"/></noscript></div></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">A RNN Network (<a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" class="bl cw mt mu mv mw" target="_blank" rel="noopener">Source</a>)</figcaption></figure><p id="0d5f" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">As seen in the above picture it is basically a sequence of copies of the cells, where output of each cell is forwarded as input to the next. LSTM network are essentially the same but each cell architecture is a bit more complex. This complexity as seen below allows the each cells to decide which of the past information to remember and the ones to forget, if you want more information on the inner working of a LSTM please go to this amazing <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" class="bl cw mt mu mv mw" target="_blank" rel="noopener">blog</a> <em class="nq">(The illustrations are sourced from this blog).</em></p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="oj ok bi ol ab"><div class="x y or"><div class="lz l bi ma"><div class="ot l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_5_DsbLOQt9pYuqTy.png" width="2000" height="751" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="2000" height="751" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/0_5_DsbLOQt9pYuqTy(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/4000/0*5_DsbLOQt9pYuqTy.png" width="2000" height="751" role="presentation"/></noscript></div></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">A LSTM Cell (<a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" class="bl cw mt mu mv mw" target="_blank" rel="noopener">Source</a>)</figcaption></figure><p id="442c" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">We are going to create the network using Keras. Keras is built on tensorflow and can be used to build most types of deep learning models. We are going to specify the layers of the model as below. In order to estimate the parameters such as dropout, no of cells etc I have performed a grid search with different parameter values and chose the parameters with best performance.</p><p id="a156" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Layers:</strong></p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="x y ou"><div class="lz l bi ma"><div class="ov l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_iu04m9kXfzAoBNJRmy_xnw.png" width="551" height="355" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="551" height="355" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_iu04m9kXfzAoBNJRmy_xnw(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/1102/1*iu04m9kXfzAoBNJRmy_xnw.png" width="551" height="355" role="presentation"/></noscript></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">Model Architecture</figcaption></figure><p id="7f90" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Layer 1: </strong>An embedding layer of a vector size of 100 and a max length of each sentence is set to 56.</p><p id="46ac" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Layer 2: </strong>128 cell bi-directional LSTM layers, where the embedding data is fed to the network. We add a dropout of 0.2 this is used to prevent overfitting.</p><p id="b155" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Layer 3: </strong>A 512 layer dense network which takes in the input from the LSTM layer. A Dropout of 0.5 is added here.</p><p id="3396" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Layer 4: </strong>A 10 layer dense network with softmax activation, each class is used to represent a sentiment category, with class 1 representing sentiment score between 0.0 to 0.1 and class 10 representing a sentiment score between 0.9 to 1.</p><p id="e77c" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Code to create an LSTM model in Keras:</p><pre class="lr ls lt lu lv ip gs dn"><span id="72d9" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">import os<br>import numpy as np<br>import keras<br>from keras.models import Sequential<br>from keras.layers import Dense<br>from keras.layers import Flatten<br>from keras.layers import LSTM<br>from keras.layers.embeddings import Embedding<br>from keras.layers import Bidirectional<br>from keras.preprocessing import sequence<br>from keras.layers import Dropout<br>from keras.models import model_from_json<br>from keras.models import load_model</span><span id="78c6" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""><br>def create_model_rnn(weight_matrix, max_words, EMBEDDING_DIM):</span><span id="4902" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># create the model</span><span id="d927" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">model = Sequential()<br>model.add(Embedding(len(weight_matrix), EMBEDDING_DIM, weights=[weight_matrix], input_length=max_words, trainable=False))<br>model.add(Bidirectional(LSTM(128, dropout=0.2, recurrent_dropout=0.2)))<br>model.add(Dense(512, activation='relu'))<br>model.add(Dropout(0.50))<br>model.add(Dense(10, activation='softmax'))</span><span id="5670" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># Adam Optimiser<br>model.compile(loss='categorical_crossentropy',optimizer='adam', metrics=['accuracy'])</span><span id="dfab" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">return model</span></pre><h2 id="fd8f" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph=""><strong class="br">Step 4: Model Parameters:</strong></h2><p id="4b35" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph=""><strong class="mh mx">Activation Function:</strong> I have used ReLU as the activation function. ReLU is a non-linear activation function, which helps complex relationships in the data to be captured by the model.</p><p id="8113" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Optimiser:</strong> We use adam optimiser, which is an adaptive learning rate optimiser.</p><p id="ec9c" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph=""><strong class="mh mx">Loss function:</strong> We will train a network to output a probability over the 10 classes using <strong class="mh mx">Cross-Entropy loss</strong>, also called Softmax Loss. It is very useful for multi-class classification.</p><h2 id="d235" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Step 5: Train and test the model</h2><p id="d87a" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">We start the training of the model by passing the train, validation and test data set into the function below:</p><pre class="lr ls lt lu lv ip gs dn"><span id="0aff" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">def train_model(model,train_x, train_y, test_x, test_y, val_x, val_y, batch_size):</span><span id="7deb" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># save the best model and early stopping<br>saveBestModel = keras.callbacks.ModelCheckpoint('../best_weight_glove_bi_100d.hdf5', monitor='val_acc', verbose=0, save_best_only=True, save_weights_only=False, mode='auto', period=1)</span><span id="c5e6" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">earlyStopping = keras.callbacks.EarlyStopping(monitor='val_loss', min_delta=0, patience=3, verbose=0, mode='auto')</span><span id="70db" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># Fit the model<br>model.fit(train_x, train_y, batch_size=batch_size, epochs=25,validation_data=(val_x, val_y), callbacks=[saveBestModel, earlyStopping])</span><span id="b51b" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># Final evaluation of the model<br>score, acc = model.evaluate(test_x, test_y, batch_size=batch_size)<br>return model</span></pre><p id="94ec" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">I have run the training on a <strong class="mh mx">batch size of</strong> <strong class="mh mx">500</strong> items at a time. As you increase the batch size the time for training would reduce but it will require additional computational capacity. Hence it is a trade-off between computation capacity and time for training.</p><p id="6341" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The training is set to run for 25 epochs. One epoch would mean that the network has seen the entire training data once. As we increase the number of epochs there is a risk that the model will overfit to the training data. Hence to prevent the model from overfitting I have enabled early stopping.</p><p id="9c47" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Early stopping is a method that allows us to specify an arbitrary large number of training epochs and stop training once the model performance stops improving on a hold out/validation dataset.</p><p id="4327" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The model on the test set of 10 class sentiment classification provides a result of <strong class="mh mx">48.6% </strong>accuracy. The accuracy will be much more higher on a 2 class binary (positive or negative) data set.</p><h2 id="a4ad" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Step 6: Run the model</h2><p id="cf84" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">Once the model is trained you can save the model in keras using the below code.</p><pre class="lr ls lt lu lv ip gs dn"><span id="118c" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">model.save_weights("/model/best_model.h5")</span></pre><p id="531c" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">The next step is to use the trained model in real time to run predictions on new data. In order to do this you will need to transform the input data to embeddings, similar to the way we treated our training data. The function <em class="nq">live_test</em> below performs the required pre-processing of the data and returns the result of the trained model.</p><p id="9e83" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Here in order to ensure robustness of the results of the model I am taking the average top 3 sentiments bands from the model. This provides a better calibration for the model results.</p><pre class="lr ls lt lu lv ip gs dn"><span id="f4b2" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph="">def live_test(trained_model, data, word_idx):</span><span id="5825" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">live_list = []<br>live_list_np = np.zeros((56,1))</span><span id="9ff6" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># split the sentence into its words and remove any punctuations.</span><span id="18fb" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">tokenizer = RegexpTokenizer(r'\w+')<br>data_sample_list = tokenizer.tokenize(data)<br>labels = np.array(['1','2','3','4','5','6','7','8','9','10'], dtype = "int")</span><span id="85af" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># get index for the live stage<br>data_index = np.array([word_idx[word.lower()] if word.lower() in word_idx else 0 for word in data_sample_list])<br>data_index_np = np.array(data_index)</span><span id="300d" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># padded with zeros of length 56 i.e maximum length<br>padded_array = np.zeros(56)<br>padded_array[:data_index_np.shape[0]] = data_index_np<br>data_index_np_pad = padded_array.astype(int)<br>live_list.append(data_index_np_pad)<br>live_list_np = np.asarray(live_list)</span><span id="3193" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># get score from the model<br>score = trained_model.predict(live_list_np, batch_size=1, verbose=0)<br>single_score = np.round(np.argmax(score)/10, decimals=2) # maximum of the array i.e single band</span><span id="061c" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># weighted score of top 3 bands<br>top_3_index = np.argsort(score)[0][-3:]<br>top_3_scores = score[0][top_3_index]<br>top_3_weights = top_3_scores/np.sum(top_3_scores)<br>single_score_dot = np.round(np.dot(top_3_index, top_3_weights)/10, decimals = 2)</span><span id="40fe" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph="">return single_score_dot, single_score</span></pre><p id="4d86" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">As seen in the code below, you can specify the model path, sample data and the corresponding embeddings to the live_test function. It will return the sentiment of the sample data.</p><pre class="lr ls lt lu lv ip gs dn"><span id="14ed" class="my mz ch ao nr b bg ns nt l nu" data-selectable-paragraph=""># Load the best model that is saved in previous step<br>weight_path = '/model/best_model.hdf5'<br>loaded_model = load_model(weight_path)</span><span id="bd4a" class="my mz ch ao nr b bg nv nw nx ny nz nt l nu" data-selectable-paragraph=""># sample sentence<br>data_sample = "This blog is really interesting."<br>result = live_test(loaded_model,data_sample, word_idx)</span></pre><h2 id="0204" class="my mz ch ao an ew na nb nc nd ne nf ng nh ni nj nk" data-selectable-paragraph="">Results</h2><p id="f80b" class="mf mg ch ao mh b mi nl mk nm mm nn mo no mq np ms" data-selectable-paragraph="">Let us compare the results of our deep learning model to the NLTK model by taking a sample.</p><p id="d6c7" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">LSTM Model: This sentence <em class="nq">“Great!! it is raining today!!”</em> contains negative context and our model is able to predict this as seen below. it gives it a score of 0.34.</p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="oj ok bi ol ab"><div class="x y ow"><div class="lz l bi ma"><div class="ox l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_9KZJVTt5-Hl2QR4Hib5DmA.png" width="769" height="75" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="769" height="75" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_9KZJVTt5-Hl2QR4Hib5DmA(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/1538/1*9KZJVTt5-Hl2QR4Hib5DmA.png" width="769" height="75" role="presentation"/></noscript></div></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">LSTM Model</figcaption></figure><p id="50b1" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">NLTK Model: The same sentence when analysed by the bi-gram NLTK model, scores it as being positive with a score of 0.74.</p><figure class="lr ls lt lu lv ge x y paragraph-image"><div class="x y oy"><div class="lz l bi ma"><div class="oz l"><div class="bh lw hp n o ho ab ba lx ly"><img alt="" class="hp n o ho ab mc md st su" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_kh7NUpqJpnerkgXZen05Ew.png" width="536" height="163" role="presentation"></div><img alt="" class="sr ss hp n o ho ab hm" width="536" height="163" role="presentation" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_kh7NUpqJpnerkgXZen05Ew(1).png"><noscript><img alt="" class="hp n o ho ab" src="https://miro.medium.com/max/1072/1*kh7NUpqJpnerkgXZen05Ew.png" width="536" height="163" role="presentation"/></noscript></div></div></div><figcaption class="as bg on oo ir el x y op oq an dy" data-selectable-paragraph="">NLTK Model</figcaption></figure><p id="e79a" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Hurray !! This comes to the end of the tutorial of creating a deep learning sentiment classification model for text data.</p><p id="c23b" class="mf mg ch ao mh b mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">You can download the source code from <a href="https://gitlab.com/praj88/deepsentiment" class="bl cw mt mu mv mw" target="_blank" rel="noopener">gitlab</a> and play around to train the network on your own data. I will cover on how to deploy this model on scale using dockers and api service in a separate blog.</p></div></section></div></article><div class="bh en eo m ep eq er es et e" data-test-id="post-sidebar"><div class="af em"><div class="eu ev l"><a href="https://towardsdatascience.com/?source=post_sidebar--------------------------post_sidebar-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" rel="noopener"><h2 class="an ew ex ap ch">Towards Data Science</h2></a><div class="ey ez l"><h4 class="an dy bg ap ba fa az fb fc fd as">Sharing concepts, ideas, and codes.</h4></div><div class="bc"><button class="cg ci fe ff fg fh fi fj bu ct an b ao ap aq ar cu cv ae bc cw bx">Follow</button></div></div><div class="fk fl fm af"><div class="af ag"><div class="fn l bi"><div class=""><button class="bs fo fp fq fr fs ft fu ff fv fi"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="fw l"><div class="fx"><h4 class="an dy bg ap as"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca">111 </button></h4></div></div></div></div><div class="fy"><div><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="bh en eo m fz eq ga gb et gc"></div><div><div class="gd ge af em gf"><div class="af gf"><div class="gg gh gi gj gk gl ab"><div class="af gm"></div><div class="af ag gm"></div><div class="gn l"><ul class="bs bt"><li class="bc dl go gp"><a href="https://towardsdatascience.com/tag/machine-learning" class="gq gr cw as l gs gt a b dz">Machine Learning</a></li><li class="bc dl go gp"><a href="https://towardsdatascience.com/tag/sentiment-analysis" class="gq gr cw as l gs gt a b dz">Sentiment Analysis</a></li><li class="bc dl go gp"><a href="https://towardsdatascience.com/tag/lstm" class="gq gr cw as l gs gt a b dz">Lstm</a></li><li class="bc dl go gp"><a href="https://towardsdatascience.com/tag/deep-learning" class="gq gr cw as l gs gt a b dz">Deep Learning</a></li></ul></div><div class="gu af gv u"><div class="af ag"><div class="cf l bi"><div class=""><div class="c gw cz af ag gx bi gy gz ha hb hc hd he hf hg hh hi hj hk fj"><button class="bs fo fp fq fr fs hl fu ag hm cz af gf hn o ho hp n ab ff fv fi hq"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></button></div></div></div><div class="fw l"><div class="fx"><h4 class="an dy bg ap ch"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca">111 claps</button></h4></div></div></div><div class="af ag"><div class="hr l am g"><a href="https://medium.com/p/2f0a0c6472b5/share/twitter?source=follow_footer--------------------------follow_footer-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" target="_blank" rel="noopener"><svg width="29" height="29" class="al"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="hr l am g"><a href="https://medium.com/p/2f0a0c6472b5/share/facebook?source=follow_footer--------------------------follow_footer-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" target="_blank" rel="noopener"><svg width="29" height="29" class="al"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="hr hs de"><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" class="al"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="hr l am"><div class="fy"><div><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div><div class="bc"><div class="bc"><div class="l am"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="al"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div><div class="ht hu hv gn l u"><div class="hw hx l bi"><span class="l hy ai hz"><div class="l hp ia ib"><a href="https://towardsdatascience.com/@prajwalshreyas?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Prajwal Shreyas" class="l cz dr ic" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_icUgBe3HTwAJt--svKBHfQ(1).jpeg" width="80" height="80"></a></div><span class="l"><div class="id l ie"><p class="an dy dz ap as eb if">Written by</p></div><div class="id ig af ie"><div class="ab af ag gv"><h2 class="an ew ih ii ch"><a href="https://towardsdatascience.com/@prajwalshreyas?source=follow_footer--------------------------follow_footer-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" rel="noopener">Prajwal Shreyas</a></h2><div class="l g"><button class="cg ci fe ff fg fh fi fj bu ct an b ao ap aq ar cu cv ae bc cw bx">Follow</button></div></div></div></span></span><div class="id ij l ie de"><div class="ik l"><h4 class="an dy ex il as">Data Scientist/ ML Engineer — Experienced in building and deploying large scale ML models to enhance business value.</h4></div><div class="hs im de"><button class="cg ci fe ff fg fh fi fj bu ct an b ao ap aq ar cu cv ae bc cw bx">Follow</button></div></div></div><div class="ht l"></div><div class="hw hx l bi"><span class="l hy ai hz"><div class="l hp ia ib"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Towards Data Science" class="ct ic dr" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_F0LADxTtsKOgmPa-_7iUEQ.jpeg" width="80" height="80"></a></div><span class="l"><div class="id ig af ie"><div class="ab af ag gv"><h2 class="an ew ih ii ch"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" rel="noopener">Towards Data Science</a></h2><div class="l g"><div class="bc"><button class="cg ci fe ff fg fh fi fj bu ct an b ao ap aq ar cu cv ae bc cw bx">Follow</button></div></div></div></div></span></span><div class="id in l ie de"><div class="ik l"><h4 class="an dy ex il as">Sharing concepts, ideas, and codes.</h4></div><div class="hs im de"><div class="bc"><button class="cg ci fe ff fg fh fi fj bu ct an b ao ap aq ar cu cv ae bc cw bx">Follow</button></div></div></div></div></div><div class="io hu l u"><a href="https://medium.com/p/2f0a0c6472b5/responses/show?source=follow_footer--------------------------follow_footer-" class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca" rel="noopener"><div class="ip iq gq l ir de"><span class="fe">See responses (1)</span></div></a></div></div></div><div class="is l it u"><div class="af gf"><div class="gg gh gi gj gk iu ab"><div class="sv l sw"><div class="kf ev hw l"><h2 class="an ew sx sy ch">More From Medium</h2></div><div class="do af sz gm ta tb tc td te tf tg th ti tj tk tl tm tn to"><div class="tp tq tr ts tt tu tv tw tx ty tz ua ub uc ud ue uf ug uh ui uj"><div class="ab ho"><div class="l uk"><div class="ul um ta tb tc un uo td te tf up uq tg th ti ur us tj tk tl ut uu tm tn to af gm"><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="vd l qb f"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><div class="aw l ve sw"><a class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca l" rel="noopener" href="https://towardsdatascience.com/deepmind-quietly-open-sourced-three-new-impressive-reinforcement-learning-frameworks-f99443910b16?source=post_recirc---------0------------------"><div class="vf bi"><div class="ho hp ab"><div class="vg l vh vi ho ab vj vk"></div></div></div></a></div></div><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="aw l"><div class="vl hs h vm"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><a rel="noopener" href="https://towardsdatascience.com/deepmind-quietly-open-sourced-three-new-impressive-reinforcement-learning-frameworks-f99443910b16?source=post_recirc---------0------------------"><h3 class="ch al kw qv ao vn vo vp">DeepMind Quietly Open Sourced Three New Impressive Reinforcement Learning Frameworks</h3></a></div><div class="af ag gv"><div class="cc l dk"><div class="ag af"><div><a href="https://towardsdatascience.com/@jrodthoughts?source=post_recirc---------0------------------" rel="noopener"><img alt="Jesus Rodriguez" class="l cz vq vr" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_9hmRpqiPP9vEjlGS2AJnaw.jpeg" width="40" height="40"></a></div><div class="li ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="an b ao ap aq ar l ch al"><div class="eh af ag lk"><span class="an dy bg ap ba ll az fb lm fd ch"><a href="https://towardsdatascience.com/@jrodthoughts?source=post_recirc---------0------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Jesus Rodriguez</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------0------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="an b ao ap aq ar l as at"><span class="an dy bg ap ba ll az fb lm fd as"><div><a class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener" href="https://towardsdatascience.com/deepmind-quietly-open-sourced-three-new-impressive-reinforcement-learning-frameworks-f99443910b16?source=post_recirc---------0------------------">Sep 16</a> · 5 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="fn l bi"><div class=""><button class="bs fo fp fq fr fs ft pa fy vs vt"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="fw l"><div class="fx"><h4 class="an dy bg ap as">1.5K </h4></div></div></div><div class="vu li cc ds vv l"></div><div class="fy"><div><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="tp tq tr ts tt tu tv tw tx ty tz ua ub uc ud ue uf ug uh ui uj"><div class="ab ho"><div class="l uk"><div class="ul um ta tb tc un uo td te tf up uq tg th ti ur us tj tk tl ut uu tm tn to af gm"><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="vd l qb f"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><div class="aw l ve sw"><a class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca l" rel="noopener" href="https://towardsdatascience.com/python-tricks-101-what-every-new-programmer-should-know-c512a9787022?source=post_recirc---------1------------------"><div class="vf bi"><div class="ho hp ab"><div class="vw l vh vi ho ab vj vk"></div></div></div></a></div></div><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="aw l"><div class="vl hs h vm"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><a rel="noopener" href="https://towardsdatascience.com/python-tricks-101-what-every-new-programmer-should-know-c512a9787022?source=post_recirc---------1------------------"><h3 class="ch al kw qv ao vn vo vp">Python tricks 101, what every new programmer should know.</h3></a></div><div class="af ag gv"><div class="cc l dk"><div class="ag af"><div><a href="https://towardsdatascience.com/@peter.nistrup?source=post_recirc---------1------------------" rel="noopener"><img alt="Peter Nistrup" class="l cz vq vr" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/2_lioTkcozjT7WSa4K5WOcJg.jpeg" width="40" height="40"></a></div><div class="li ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="an b ao ap aq ar l ch al"><div class="eh af ag lk"><span class="an dy bg ap ba ll az fb lm fd ch"><a href="https://towardsdatascience.com/@peter.nistrup?source=post_recirc---------1------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Peter Nistrup</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------1------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="an b ao ap aq ar l as at"><span class="an dy bg ap ba ll az fb lm fd as"><div><a class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener" href="https://towardsdatascience.com/python-tricks-101-what-every-new-programmer-should-know-c512a9787022?source=post_recirc---------1------------------">Sep 13</a> · 6 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="fn l bi"><div class=""><button class="bs fo fp fq fr fs ft pa fy vs vt"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="fw l"><div class="fx"><h4 class="an dy bg ap as">1.8K </h4></div></div></div><div class="vu li cc ds vv l"></div><div class="fy"><div><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="tp tq tr ts tt tu tv tw tx ty tz ua ub uc ud ue uf ug uh ui uj"><div class="ab ho"><div class="l uk"><div class="ul um ta tb tc un uo td te tf up uq tg th ti ur us tj tk tl ut uu tm tn to af gm"><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="vd l qb f"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><div class="aw l ve sw"><a class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca l" rel="noopener" href="https://towardsdatascience.com/data-science-is-boring-1d43473e353e?source=post_recirc---------2------------------"><div class="vf bi"><div class="ho hp ab"><div class="vx l vh vi ho ab vj vk"></div></div></div></a></div></div><div class="tp tq tr ts tt tu uv uw tx ty ux uy ub uc uz va uf ug vb vc uj"><div class="aw l"><div class="vl hs h vm"><h4 class="an dy bg ap as">More from Towards Data Science</h4></div><a rel="noopener" href="https://towardsdatascience.com/data-science-is-boring-1d43473e353e?source=post_recirc---------2------------------"><h3 class="ch al kw qv ao vn vo vp">Data Science is Boring</h3></a></div><div class="af ag gv"><div class="cc l dk"><div class="ag af"><div><a href="https://towardsdatascience.com/@ianxiao?source=post_recirc---------2------------------" rel="noopener"><img alt="Ian Xiao" class="l cz vq vr" src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/1_YiMe8m9a8bmqOUzprwkalg.png" width="40" height="40"></a></div><div class="li ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="an b ao ap aq ar l ch al"><div class="eh af ag lk"><span class="an dy bg ap ba ll az fb lm fd ch"><a href="https://towardsdatascience.com/@ianxiao?source=post_recirc---------2------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Ian Xiao</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------2------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="an b ao ap aq ar l as at"><span class="an dy bg ap ba ll az fb lm fd as"><div><a class="bl bm bn bo bp bq br bs bt bu kj bx by bz ca" rel="noopener" href="https://towardsdatascience.com/data-science-is-boring-1d43473e353e?source=post_recirc---------2------------------">Sep 9</a> · 9 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="fn l bi"><div class=""><button class="bs fo fp fq fr fs ft pa fy vs vt"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="fw l"><div class="fx"><h4 class="an dy bg ap as">3.1K </h4></div></div></div><div class="vu li cc ds vv l"></div><div class="fy"><div><div class="bc"><button class="bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="iv l iw ix"><section class="x y ab ae l iy iz ja jb jc jd je jf jg jh ji jj jk jl jm"><div class="jn jo hw af gv g"><div class="jp af gv"><div class="jq l jr"><div class="js l"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu jt ju bx by jv jw" rel="noopener"><h4 class="jx jy jz an ew ao il ka kb l">Discover <!-- -->Medium</h4></a></div><span class="an b ao ap aq ar l kc kd">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu bx by jv jw ke" rel="noopener">Watch</a></span></div><div class="jq l jr"><div class="kf l"><a href="https://medium.com/topics?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu jt ju bx by jv jw" rel="noopener"><h4 class="jx jy jz an ew ao il ka kb l">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="an b ao ap aq ar l kc kd">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu bx by jv jw ke" rel="noopener">Explore</a></span></div><div class="jq l jr"><div class="js l"><a href="https://medium.com/membership?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu jt ju bx by jv jw" rel="noopener"><h4 class="jx jy jz an ew ao il ka kb l">Become a member</h4></a></div><span class="an b ao ap aq ar l kc kd">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu bx by jv jw ke" rel="noopener">Upgrade</a></span></div></div></div><div class="af ag gv"><a href="https://medium.com/?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu jt ju bx by jv jw" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="jy"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="an b ao ap aq ar l kc kd"><div class="kg kh af gv ki ai"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by jv jw" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by jv jw" rel="noopener">Help</a><a href="https://medium.com/policy/9db0094a1e0f?source=post_page-----2f0a0c6472b5----------------------" class="bl bm bn bo bp bq br bs bt bu kj bx by jv jw" rel="noopener">Legal</a></div></span></div></section></div></div></div><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20190920-213519-519a3ad6c3","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","iTunesAppId":"828256236","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20190920-213519-519a3ad6c3"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b"]},"debug":{"requestId":"18c90989-0aa2-4361-a7f5-a01119cf9a70","originalSpanCarrier":{"ot-tracer-spanid":"0d5cf2c2202d2ed6","ot-tracer-traceid":"2386386114c3e5c0","ot-tracer-sampled":"true"}},"session":{"user":{"id":"de592e962405"},"xsrf":"Si0SeGNdn6EH"},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hideGoogleOneTap":false,"branchData":{"loaded":false},"showNewPostStatsPage":false,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fsentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5","host":"towardsdatascience.com","hostname":"towardsdatascience.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","currentHash":""},"client":{"isBot":false,"isDnt":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":true},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.4":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.5":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.6":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.7":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_daily_read_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_inline_search_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_inline_search_popover_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.24":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_limit_diversification_heuristic","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_lite_image_zoom","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_lite_read_next","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagString","value":"sidebar"},"ROOT_QUERY.variantFlags.35":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_lite_twitter_text_shots","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_live_user_post_scoring","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_popular_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_quarantine_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_rank_service_newsletters","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_serve_recs_from_ml_rank_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_serve_recs_from_ml_rank_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_serve_recs_from_ml_rank_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_ticks_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.63":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.68":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.70":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.71":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"}],"viewer":{"type":"id","generated":false,"id":"User:de592e962405","typename":"User"},"meterPost({\"postId\":\"2f0a0c6472b5\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"2f0a0c6472b5\"})":{"type":"id","generated":false,"id":"Post:2f0a0c6472b5","typename":"Post"},"notificationsConnection({})":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({})","typename":"NotificationsConnection"},"notificationStatus":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationStatus","typename":"NotificationStatus"}},"User:de592e962405":{"id":"de592e962405","username":"aabannay","name":"Abdullah AlBannay","imageId":"0*b13lZgxJPD06oz0K.jpg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"aabannay@gmail.com","unverifiedEmail":"","createdAt":1546594274564,"__typename":"User"},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":["181e24085abd","f3a59641e86d","2f0a0c6472b5"]},"maxUnlockCount":4,"unlocksRemaining":1},"Post:2f0a0c6472b5":{"__typename":"Post","visibility":"LOCKED","latestPublishedVersion":"23341b537de","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"id":"2f0a0c6472b5","creator":{"type":"id","generated":false,"id":"User:daf1da2a65fa","typename":"User"},"isLocked":true,"lockedSource":"LOCKED_POST_SOURCE_UGC_UNENROLLED","sequence":null,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fsentiment-analysis-for-text-with-deep-learning-2f0a0c6472b5","canonicalUrl":"","content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":true,"id":"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})","typename":"PostContent"},"firstPublishedAt":1554184259476,"isPublished":true,"layerCake":3,"primaryTopic":{"type":"id","generated":false,"id":"machine-learning","typename":"Topic"},"title":"Sentiment analysis for text with Deep Learning","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":"APPROVED","readingTime":8.604716981132075,"license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:machine-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:sentiment-analysis","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:lstm","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:deep-learning","typename":"Tag"}],"viewerClapCount":null,"readingList":"READING_LIST_NONE","clapCount":111,"voterCount":38,"recommenders":[],"responsesCount":1,"collaborators":[],"translationSourcePost":null,"inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":1554184257925,"audioVersionUrl":null,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1554470836890,"previewContent":{"type":"id","generated":true,"id":"$Post:2f0a0c6472b5.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:0*33q1bTIm6jOzZXf_.png","typename":"ImageMetadata"},"updatedAt":1554470837104,"topics":[{"type":"id","generated":false,"id":"machine-learning","typename":"Topic"}],"isSuspended":false},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","domain":"towardsdatascience.com","slug":"towards-data-science","__typename":"Collection","googleAnalyticsId":"UA-19707169-24","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","name":"Towards Data Science","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*5EUO1kUYBthpOCPzRj_l2g.png","typename":"ImageMetadata"},"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","typename":"ImageMetadata"},"isEnrolledInHightower":false,"creator":{"type":"id","generated":false,"id":"User:895063a310f4","typename":"User"},"viewerIsEditor":false,"navItems":[{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.5","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.6","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.7","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette","typename":"ColorPalette"},"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"Sharing concepts, ideas, and codes.","viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"isUserSubscribedToCollectionEmails":false,"ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","typename":"ImageMetadata"}},"User:daf1da2a65fa":{"id":"daf1da2a65fa","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Prajwal Shreyas","isFollowing":false,"username":"prajwalshreyas","bio":"Data Scientist\u002F ML Engineer — Experienced in building and deploying large scale ML models to enhance business value.","imageId":"1*icUgBe3HTwAJt--svKBHfQ.jpeg","mediumMemberAt":0,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"ImageMetadata:1*5EUO1kUYBthpOCPzRj_l2g.png":{"id":"1*5EUO1kUYBthpOCPzRj_l2g.png","originalWidth":1010,"originalHeight":376,"__typename":"ImageMetadata"},"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg":{"id":"1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","__typename":"ImageMetadata"},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"Collection:7f60cf5620c9.navItems.0":{"title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.1":{"title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.2":{"title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.3":{"title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.4":{"title":"AI","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fartificial-intelligence\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.5":{"title":"Journalism","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-journalism\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.6":{"title":"Events","url":"https:\u002F\u002Ftowardsdatascience.com\u002Ftoronto-machine-learning-summit-8bae371d4bb1","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.7":{"title":"Submit","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF355876","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF355876","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF4D6C88","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF637F99","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF7791A8","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF8CA2B7","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF9FB3C6","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFB2C3D4","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFC5D2E1","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD7E2EE","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE9F1FA","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFFBFFFF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"},"highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum","typename":"ColorSpectrum"}},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF668AAA","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF61809D","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF5A7690","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF546C83","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF4D6275","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF455768","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF3D4C5A","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF34414C","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF2B353E","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF21282F","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF161B1F","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFEDF4FC","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE9F2FD","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFE6F1FD","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFE2EFFD","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFDFEEFD","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFDBECFE","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFD7EBFE","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFD4E9FE","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFD0E7FF","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFCCE6FF","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFC8E4FF","point":1,"__typename":"ColorPoint"},"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel","typename":"RichText"}},"machine-learning":{"name":"Machine Learning","slug":"machine-learning","__typename":"Topic","isFollowing":null},"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0":{"name":"df1c","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:2f0a0c6472b5.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:23341b537de_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:23341b537de_109","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:23341b537de_0":{"id":"23341b537de_0","name":"27df","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Sentiment analysis for text with Deep Learning","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_1":{"id":"23341b537de_1","name":"92bd","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*33q1bTIm6jOzZXf_.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*33q1bTIm6jOzZXf_.png":{"id":"0*33q1bTIm6jOzZXf_.png","originalHeight":564,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_2":{"id":"23341b537de_2","name":"30a9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I started working on a NLP related project with twitter data and one of the project goals included sentiment classification for each tweet. However when I explored the available resources such as NLTK sentiment classifier and other resource available in python, I was disappointed by the performance of these models. At most I would get about 60% to 70% accuracy on binary classification (i.e only positive or negative class) tasks.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_3":{"id":"23341b537de_3","name":"4709","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Hence I started researching about ways to increase my model performance. One of the obvious choices was to build a deep learning based sentiment classification model.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_4":{"id":"23341b537de_4","name":"b1d3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I am writing this blog post to share about my experience about steps to building a deep learning model for sentiment classification and I hope you find it useful. The link to the code repository can be found here.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_4.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_4.markups.0":{"type":"A","start":208,"end":212,"href":"https:\u002F\u002Fgitlab.com\u002Fpraj88\u002Fdeepsentiment","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_5":{"id":"23341b537de_5","name":"b14d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I have designed the model to provide a sentiment score between 0 to 1 with 0 being very negative and 1 being very positive. This was done by building a multi-class classification model i.e 10 class, one class for each decile.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_6":{"id":"23341b537de_6","name":"59f3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"There are 5 major steps involved in the building a deep learning model for sentiment classification:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_6.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_6.markups.0":{"type":"STRONG","start":10,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_7":{"id":"23341b537de_7","name":"3812","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step1: Get data.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_7.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_7.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_8":{"id":"23341b537de_8","name":"f542","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step 2: Generate embeddings","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_8.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_8.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_9":{"id":"23341b537de_9","name":"3a1f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step 3: Model architecture","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_9.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_9.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_10":{"id":"23341b537de_10","name":"4840","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step 4: Model Parameters","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_10.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_10.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_11":{"id":"23341b537de_11","name":"9c24","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step 5: Train and test the model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_11.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_11.markups.0":{"type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_12":{"id":"23341b537de_12","name":"f21d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Step 6: Run the model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_12.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_12.markups.0":{"type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_13":{"id":"23341b537de_13","name":"2ab2","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I am going to cover each of the above steps in detail below.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_14":{"id":"23341b537de_14","name":"24d3","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step1: Get data","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_15":{"id":"23341b537de_15","name":"7c23","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Sourcing the labelled data for training a deep learning model is one of the most difficult parts of building a model. Fortunately we can use the Stanford sentiment treebank data for our purpose.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_15.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_15.markups.0":{"type":"A","start":145,"end":177,"href":"https:\u002F\u002Fnlp.stanford.edu\u002Fsentiment\u002Fcode.html","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_16":{"id":"23341b537de_16","name":"9141","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The data set “dictionary.txt” consists of 239,233 lines of sentences with an index for each line. The index is used to match each of the sentences to a sentiment score in the file “labels.txt”. The score ranges from 0 to 1, 0 being very negative and 1 being very positive.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_17":{"id":"23341b537de_17","name":"5a09","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The below code reads the dictionary.txt and labels.txt files, combines the score to each sentences . This code is found within train\u002Futility_function.py","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_17.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_17.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_17.markups.0":{"type":"STRONG","start":127,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_17.markups.1":{"type":"EM","start":127,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_18":{"id":"23341b537de_18","name":"b233","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def read_data(path):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_18.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_18.markups.0":{"type":"CODE","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_19":{"id":"23341b537de_19","name":"ab56","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# read dictionary into df","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_19.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_19.markups.0":{"type":"CODE","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_20":{"id":"23341b537de_20","name":"cb7e","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentence = pd.read_table(path + ‘dictionary.txt’)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_20.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_20.markups.0":{"type":"CODE","start":0,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_21":{"id":"23341b537de_21","name":"1d13","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentence_processed = df_data_sentence[‘Phrase|Index’].str.split(‘|’, expand=True)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_21.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_21.markups.0":{"type":"CODE","start":0,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_22":{"id":"23341b537de_22","name":"6613","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentence_processed = df_data_sentence_processed.rename(columns={0: ‘Phrase’, 1: ‘phrase_ids’})","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_22.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_22.markups.0":{"type":"CODE","start":0,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_23":{"id":"23341b537de_23","name":"e410","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# read sentiment labels into df","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_23.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_23.markups.0":{"type":"CODE","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_24":{"id":"23341b537de_24","name":"5ae3","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentiment = pd.read_table(path + ‘sentiment_labels.txt’)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_24.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_24.markups.0":{"type":"CODE","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_25":{"id":"23341b537de_25","name":"de54","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentiment_processed = df_data_sentiment[‘phrase ids|sentiment values’].str.split(‘|’, expand=True)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_25.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_25.markups.0":{"type":"CODE","start":0,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_26":{"id":"23341b537de_26","name":"1333","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_data_sentiment_processed = df_data_sentiment_processed.rename(columns={0: ‘phrase_ids’, 1: ‘sentiment_values’})","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_26.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_26.markups.0":{"type":"CODE","start":0,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_27":{"id":"23341b537de_27","name":"505d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#combine data frames containing sentence and sentiment","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_27.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_27.markups.0":{"type":"CODE","start":0,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_28":{"id":"23341b537de_28","name":"a999","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df_processed_all = df_data_sentence_processed.merge(df_data_sentiment_processed, how=’inner’, on=’phrase_ids’","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_28.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_28.markups.0":{"type":"CODE","start":0,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_29":{"id":"23341b537de_29","name":"6e98","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"return df_processed_all","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_29.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_29.markups.0":{"type":"CODE","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_30":{"id":"23341b537de_30","name":"39e1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The data is split into 3 parts:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_31":{"id":"23341b537de_31","name":"2e5d","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"train.csv : This is the main data which is used to train the model. This is 50% of the overall data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_32":{"id":"23341b537de_32","name":"3c8d","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"val.csv : This is a validation data set to be used to ensure the model does not overfit. This is 25% of the overall data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_33":{"id":"23341b537de_33","name":"805d","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"test.csv : This is used to test the accuracy of the model post training. This is 25% of the overall data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_34":{"id":"23341b537de_34","name":"99fa","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step 2: Generate embeddings","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_35":{"id":"23341b537de_35","name":"1c3d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Prior to training this model we are going to convert each of the words into a word embedding. You can think of word embeddings as numerical representation of words to enable our model to learn. For more details on word embeddings please read this blog.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_35.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_35.markups.0":{"type":"A","start":247,"end":251,"href":"https:\u002F\u002Fwww.datascience.com\u002Fresources\u002Fnotebooks\u002Fword-embeddings-in-python","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_36":{"id":"23341b537de_36","name":"22b6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"What are word embeddings?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_36.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_36.markups.0":{"type":"EM","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_37":{"id":"23341b537de_37","name":"b5dd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"They are vector representations that capture the context of the underlying words in relation to other words in the sentence. This transformation results in words having similar meaning being clustered closer together in the hyperplane and distinct words positioned further away in the hyperplane.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_38":{"id":"23341b537de_38","name":"f35a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"How are we going to convert each word into a word embeddings?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_38.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_38.markups.0":{"type":"EM","start":0,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_39":{"id":"23341b537de_39","name":"ed24","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"We are going to use a pre-trained word embedding model know as GloVe. For our model we are going to represent each word using a 100 dimension embedding. The detailed code for converting the data into word embedding is in within train\u002Futility_function.py. This function basically replace each of the words by its respective embedding by performing a lookup from the GloVe pre-trained vectors. An illustration of the process is shown below, where each word is converted into an embedding and fed into a neural network.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_39.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_39.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_39.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_39.markups.0":{"type":"A","start":63,"end":68,"href":"https:\u002F\u002Fnlp.stanford.edu\u002Fprojects\u002Fglove\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_39.markups.1":{"type":"STRONG","start":228,"end":255,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_39.markups.2":{"type":"EM","start":228,"end":255,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_40":{"id":"23341b537de_40","name":"a142","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*lNsgjlmv5FFVUxm7.png","typename":"ImageMetadata"},"text":"Converting Sentences to Embedding for a Neural Network (Source)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_40.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*lNsgjlmv5FFVUxm7.png":{"id":"0*lNsgjlmv5FFVUxm7.png","originalHeight":694,"originalWidth":1414,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_40.markups.0":{"type":"A","start":56,"end":62,"href":"https:\u002F\u002Fwww.datascience.com\u002Fresources\u002Fnotebooks\u002Fword-embeddings-in-python","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_41":{"id":"23341b537de_41","name":"e6ec","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The below code is used to split the data into train, val and test sets. Also the corresponding embeddings for the data is stored in the weight_matrix variable.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_42":{"id":"23341b537de_42","name":"bd43","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def load_data_all(data_dir, all_data_path,pred_path, gloveFile, first_run, load_all):","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_43":{"id":"23341b537de_43","name":"0a64","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"   numClasses = 10","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_44":{"id":"23341b537de_44","name":"29ae","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Load embeddings for the filtered glove list\n    if load_all == True:\n        weight_matrix, word_idx = uf.load_embeddings(gloveFile)\n    else:\n        weight_matrix, word_idx = uf.load_embeddings(filtered_glove_path)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_45":{"id":"23341b537de_45","name":"a530","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # create test, validation and trainng data\n    all_data = uf.read_data(all_data_path)\n    train_data, test_data, dev_data = uf.training_data_split(all_data, 0.8, data_dir)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_46":{"id":"23341b537de_46","name":"8a99","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"train_data = train_data.reset_index()\n    dev_data = dev_data.reset_index()\n    test_data = test_data.reset_index()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_47":{"id":"23341b537de_47","name":"a1ae","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    maxSeqLength, avg_words, sequence_length = uf.maxSeqLen(all_data)\n  ","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_48":{"id":"23341b537de_48","name":"2955","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# load Training data matrix\n    train_x = uf.tf_data_pipeline_nltk(train_data, word_idx, weight_matrix, maxSeqLength)\n    test_x = uf.tf_data_pipeline_nltk(test_data, word_idx, weight_matrix, maxSeqLength)\n    val_x = uf.tf_data_pipeline_nltk(dev_data, word_idx, weight_matrix, maxSeqLength)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_49":{"id":"23341b537de_49","name":"1101","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # load labels data matrix\n    train_y = uf.labels_matrix(train_data)\n    val_y = uf.labels_matrix(dev_data)\n    test_y = uf.labels_matrix(test_data)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_50":{"id":"23341b537de_50","name":"a5c1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"return train_x, train_y, test_x, test_y, val_x, val_y, weight_matrix","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_51":{"id":"23341b537de_51","name":"bd3f","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step3: Model architecture","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_52":{"id":"23341b537de_52","name":"35df","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In order to train the model we are going to use a type of Recurrent Neural Network, know as LSTM (Long Short Term Memory). The main advantage of this network is that it is able to remember the sequence of past data i.e. words in our case in order to make a decision on the sentiment of the word.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_53":{"id":"23341b537de_53","name":"75b4","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*hkpZ3Ezkn7KINHKP.png","typename":"ImageMetadata"},"text":"A RNN Network (Source)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_53.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*hkpZ3Ezkn7KINHKP.png":{"id":"0*hkpZ3Ezkn7KINHKP.png","originalHeight":525,"originalWidth":2000,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_53.markups.0":{"type":"A","start":15,"end":21,"href":"http:\u002F\u002Fcolah.github.io\u002Fposts\u002F2015-08-Understanding-LSTMs\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_54":{"id":"23341b537de_54","name":"0d5f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As seen in the above picture it is basically a sequence of copies of the cells, where output of each cell is forwarded as input to the next. LSTM network are essentially the same but each cell architecture is a bit more complex. This complexity as seen below allows the each cells to decide which of the past information to remember and the ones to forget, if you want more information on the inner working of a LSTM please go to this amazing blog (The illustrations are sourced from this blog).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_54.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_54.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_54.markups.0":{"type":"A","start":443,"end":447,"href":"http:\u002F\u002Fcolah.github.io\u002Fposts\u002F2015-08-Understanding-LSTMs\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_54.markups.1":{"type":"EM","start":448,"end":495,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_55":{"id":"23341b537de_55","name":"3e57","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*5_DsbLOQt9pYuqTy.png","typename":"ImageMetadata"},"text":"A LSTM Cell (Source)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_55.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*5_DsbLOQt9pYuqTy.png":{"id":"0*5_DsbLOQt9pYuqTy.png","originalHeight":751,"originalWidth":2000,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_55.markups.0":{"type":"A","start":13,"end":19,"href":"http:\u002F\u002Fcolah.github.io\u002Fposts\u002F2015-08-Understanding-LSTMs\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_56":{"id":"23341b537de_56","name":"442c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"We are going to create the network using Keras. Keras is built on tensorflow and can be used to build most types of deep learning models. We are going to specify the layers of the model as below. In order to estimate the parameters such as dropout, no of cells etc I have performed a grid search with different parameter values and chose the parameters with best performance.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_57":{"id":"23341b537de_57","name":"a156","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Layers:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_57.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_57.markups.0":{"type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_58":{"id":"23341b537de_58","name":"18f2","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*iu04m9kXfzAoBNJRmy_xnw.png","typename":"ImageMetadata"},"text":"Model Architecture","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iu04m9kXfzAoBNJRmy_xnw.png":{"id":"1*iu04m9kXfzAoBNJRmy_xnw.png","originalHeight":355,"originalWidth":551,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_59":{"id":"23341b537de_59","name":"7f90","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Layer 1: An embedding layer of a vector size of 100 and a max length of each sentence is set to 56.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_59.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_59.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_60":{"id":"23341b537de_60","name":"46ac","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Layer 2: 128 cell bi-directional LSTM layers, where the embedding data is fed to the network. We add a dropout of 0.2 this is used to prevent overfitting.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_60.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_60.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_61":{"id":"23341b537de_61","name":"b155","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Layer 3: A 512 layer dense network which takes in the input from the LSTM layer. A Dropout of 0.5 is added here.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_61.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_61.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_62":{"id":"23341b537de_62","name":"3396","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Layer 4: A 10 layer dense network with softmax activation, each class is used to represent a sentiment category, with class 1 representing sentiment score between 0.0 to 0.1 and class 10 representing a sentiment score between 0.9 to 1.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_62.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_62.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_63":{"id":"23341b537de_63","name":"e77c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Code to create an LSTM model in Keras:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_64":{"id":"23341b537de_64","name":"72d9","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import os\nimport numpy as np\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Flatten\nfrom keras.layers import LSTM\nfrom keras.layers.embeddings import Embedding\nfrom keras.layers import Bidirectional\nfrom keras.preprocessing import sequence\nfrom keras.layers import Dropout\nfrom keras.models import model_from_json\nfrom keras.models import load_model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_64.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_64.markups.0":{"type":"CODE","start":0,"end":407,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_65":{"id":"23341b537de_65","name":"78c6","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\ndef create_model_rnn(weight_matrix, max_words, EMBEDDING_DIM):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_65.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_65.markups.0":{"type":"CODE","start":0,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_66":{"id":"23341b537de_66","name":"4902","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# create the model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_66.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_66.markups.0":{"type":"CODE","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_67":{"id":"23341b537de_67","name":"d927","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model = Sequential()\nmodel.add(Embedding(len(weight_matrix), EMBEDDING_DIM, weights=[weight_matrix], input_length=max_words, trainable=False))\nmodel.add(Bidirectional(LSTM(128, dropout=0.2, recurrent_dropout=0.2)))\nmodel.add(Dense(512, activation='relu'))\nmodel.add(Dropout(0.50))\nmodel.add(Dense(10, activation='softmax'))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_67.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_67.markups.0":{"type":"CODE","start":0,"end":323,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_68":{"id":"23341b537de_68","name":"5670","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Adam Optimiser\nmodel.compile(loss='categorical_crossentropy',optimizer='adam', metrics=['accuracy'])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_68.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_68.markups.0":{"type":"CODE","start":0,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_69":{"id":"23341b537de_69","name":"dfab","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"return model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_69.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_69.markups.0":{"type":"CODE","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_70":{"id":"23341b537de_70","name":"fd8f","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step 4: Model Parameters:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_70.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_70.markups.0":{"type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_71":{"id":"23341b537de_71","name":"4b35","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Activation Function: I have used ReLU as the activation function. ReLU is a non-linear activation function, which helps complex relationships in the data to be captured by the model.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_71.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_71.markups.0":{"type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_72":{"id":"23341b537de_72","name":"8113","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Optimiser: We use adam optimiser, which is an adaptive learning rate optimiser.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_72.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_72.markups.0":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_73":{"id":"23341b537de_73","name":"ec9c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Loss function: We will train a network to output a probability over the 10 classes using Cross-Entropy loss, also called Softmax Loss. It is very useful for multi-class classification.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_73.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_73.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_73.markups.0":{"type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_73.markups.1":{"type":"STRONG","start":89,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_74":{"id":"23341b537de_74","name":"d235","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step 5: Train and test the model","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_75":{"id":"23341b537de_75","name":"d87a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"We start the training of the model by passing the train, validation and test data set into the function below:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_76":{"id":"23341b537de_76","name":"0aff","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def train_model(model,train_x, train_y, test_x, test_y, val_x, val_y, batch_size):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_76.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_76.markups.0":{"type":"CODE","start":0,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_77":{"id":"23341b537de_77","name":"7deb","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# save the best model and early stopping\nsaveBestModel = keras.callbacks.ModelCheckpoint('..\u002Fbest_weight_glove_bi_100d.hdf5', monitor='val_acc', verbose=0, save_best_only=True, save_weights_only=False, mode='auto', period=1)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_77.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_77.markups.0":{"type":"CODE","start":0,"end":224,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_78":{"id":"23341b537de_78","name":"c5e6","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"earlyStopping = keras.callbacks.EarlyStopping(monitor='val_loss', min_delta=0, patience=3, verbose=0, mode='auto')","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_78.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_78.markups.0":{"type":"CODE","start":0,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_79":{"id":"23341b537de_79","name":"70db","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Fit the model\nmodel.fit(train_x, train_y, batch_size=batch_size, epochs=25,validation_data=(val_x, val_y), callbacks=[saveBestModel, earlyStopping])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_79.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_79.markups.0":{"type":"CODE","start":0,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_80":{"id":"23341b537de_80","name":"b51b","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Final evaluation of the model\nscore, acc = model.evaluate(test_x, test_y, batch_size=batch_size)\nreturn model","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_80.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_80.markups.0":{"type":"CODE","start":0,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_81":{"id":"23341b537de_81","name":"94ec","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I have run the training on a batch size of 500 items at a time. As you increase the batch size the time for training would reduce but it will require additional computational capacity. Hence it is a trade-off between computation capacity and time for training.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_81.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:23341b537de_81.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_81.markups.0":{"type":"STRONG","start":29,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_81.markups.1":{"type":"STRONG","start":43,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_82":{"id":"23341b537de_82","name":"6341","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The training is set to run for 25 epochs. One epoch would mean that the network has seen the entire training data once. As we increase the number of epochs there is a risk that the model will overfit to the training data. Hence to prevent the model from overfitting I have enabled early stopping.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_83":{"id":"23341b537de_83","name":"9c47","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Early stopping is a method that allows us to specify an arbitrary large number of training epochs and stop training once the model performance stops improving on a hold out\u002Fvalidation dataset.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_84":{"id":"23341b537de_84","name":"4327","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The model on the test set of 10 class sentiment classification provides a result of 48.6% accuracy. The accuracy will be much more higher on a 2 class binary (positive or negative) data set.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_84.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_84.markups.0":{"type":"STRONG","start":84,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_85":{"id":"23341b537de_85","name":"a4ad","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Step 6: Run the model","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_86":{"id":"23341b537de_86","name":"cf84","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the model is trained you can save the model in keras using the below code.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_87":{"id":"23341b537de_87","name":"118c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model.save_weights(\"\u002Fmodel\u002Fbest_model.h5\")","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_87.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_87.markups.0":{"type":"CODE","start":0,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_88":{"id":"23341b537de_88","name":"531c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The next step is to use the trained model in real time to run predictions on new data. In order to do this you will need to transform the input data to embeddings, similar to the way we treated our training data. The function live_test below performs the required pre-processing of the data and returns the result of the trained model.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_88.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_88.markups.0":{"type":"EM","start":226,"end":235,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_89":{"id":"23341b537de_89","name":"9e83","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here in order to ensure robustness of the results of the model I am taking the average top 3 sentiments bands from the model. This provides a better calibration for the model results.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_90":{"id":"23341b537de_90","name":"f4b2","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def live_test(trained_model, data, word_idx):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_90.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_90.markups.0":{"type":"CODE","start":0,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_91":{"id":"23341b537de_91","name":"5825","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"live_list = []\nlive_list_np = np.zeros((56,1))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_91.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_91.markups.0":{"type":"CODE","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_92":{"id":"23341b537de_92","name":"9ff6","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# split the sentence into its words and remove any punctuations.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_92.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_92.markups.0":{"type":"CODE","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_93":{"id":"23341b537de_93","name":"18fb","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"tokenizer = RegexpTokenizer(r'\\w+')\ndata_sample_list = tokenizer.tokenize(data)\nlabels = np.array(['1','2','3','4','5','6','7','8','9','10'], dtype = \"int\")","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_93.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_93.markups.0":{"type":"CODE","start":0,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_94":{"id":"23341b537de_94","name":"85af","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# get index for the live stage\ndata_index = np.array([word_idx[word.lower()] if word.lower() in word_idx else 0 for word in data_sample_list])\ndata_index_np = np.array(data_index)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_94.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_94.markups.0":{"type":"CODE","start":0,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_95":{"id":"23341b537de_95","name":"300d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# padded with zeros of length 56 i.e maximum length\npadded_array = np.zeros(56)\npadded_array[:data_index_np.shape[0]] = data_index_np\ndata_index_np_pad = padded_array.astype(int)\nlive_list.append(data_index_np_pad)\nlive_list_np = np.asarray(live_list)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_95.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_95.markups.0":{"type":"CODE","start":0,"end":251,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_96":{"id":"23341b537de_96","name":"3193","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# get score from the model\nscore = trained_model.predict(live_list_np, batch_size=1, verbose=0)\nsingle_score = np.round(np.argmax(score)\u002F10, decimals=2) # maximum of the array i.e single band","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_96.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_96.markups.0":{"type":"CODE","start":0,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_97":{"id":"23341b537de_97","name":"061c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# weighted score of top 3 bands\ntop_3_index = np.argsort(score)[0][-3:]\ntop_3_scores = score[0][top_3_index]\ntop_3_weights = top_3_scores\u002Fnp.sum(top_3_scores)\nsingle_score_dot = np.round(np.dot(top_3_index, top_3_weights)\u002F10, decimals = 2)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_97.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_97.markups.0":{"type":"CODE","start":0,"end":239,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_98":{"id":"23341b537de_98","name":"40fe","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"return single_score_dot, single_score","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_98.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_98.markups.0":{"type":"CODE","start":0,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_99":{"id":"23341b537de_99","name":"4d86","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As seen in the code below, you can specify the model path, sample data and the corresponding embeddings to the live_test function. It will return the sentiment of the sample data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_100":{"id":"23341b537de_100","name":"14ed","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Load the best model that is saved in previous step\nweight_path = '\u002Fmodel\u002Fbest_model.hdf5'\nloaded_model = load_model(weight_path)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_100.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_100.markups.0":{"type":"CODE","start":0,"end":130,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_101":{"id":"23341b537de_101","name":"bd4a","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# sample sentence\ndata_sample = \"This blog is really interesting.\"\nresult = live_test(loaded_model,data_sample, word_idx)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_101.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_101.markups.0":{"type":"CODE","start":0,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_102":{"id":"23341b537de_102","name":"0204","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"Results","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_103":{"id":"23341b537de_103","name":"f80b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us compare the results of our deep learning model to the NLTK model by taking a sample.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_104":{"id":"23341b537de_104","name":"d6c7","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"LSTM Model: This sentence “Great!! it is raining today!!” contains negative context and our model is able to predict this as seen below. it gives it a score of 0.34.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_104.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_104.markups.0":{"type":"EM","start":26,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:23341b537de_105":{"id":"23341b537de_105","name":"3833","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*9KZJVTt5-Hl2QR4Hib5DmA.png","typename":"ImageMetadata"},"text":"LSTM Model","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9KZJVTt5-Hl2QR4Hib5DmA.png":{"id":"1*9KZJVTt5-Hl2QR4Hib5DmA.png","originalHeight":75,"originalWidth":769,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_106":{"id":"23341b537de_106","name":"50b1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"NLTK Model: The same sentence when analysed by the bi-gram NLTK model, scores it as being positive with a score of 0.74.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_107":{"id":"23341b537de_107","name":"d34d","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*kh7NUpqJpnerkgXZen05Ew.png","typename":"ImageMetadata"},"text":"NLTK Model","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kh7NUpqJpnerkgXZen05Ew.png":{"id":"1*kh7NUpqJpnerkgXZen05Ew.png","originalHeight":163,"originalWidth":536,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:23341b537de_108":{"id":"23341b537de_108","name":"e79a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Hurray !! This comes to the end of the tutorial of creating a deep learning sentiment classification model for text data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_109":{"id":"23341b537de_109","name":"c23b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"You can download the source code from gitlab and play around to train the network on your own data. I will cover on how to deploy this model on scale using dockers and api service in a separate blog.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:23341b537de_109.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:23341b537de_109.markups.0":{"type":"A","start":38,"end":44,"href":"https:\u002F\u002Fgitlab.com\u002Fpraj88\u002Fdeepsentiment","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Tag:machine-learning":{"id":"machine-learning","displayTitle":"Machine Learning","__typename":"Tag"},"Tag:sentiment-analysis":{"id":"sentiment-analysis","displayTitle":"Sentiment Analysis","__typename":"Tag"},"Tag:lstm":{"id":"lstm","displayTitle":"Lstm","__typename":"Tag"},"Tag:deep-learning":{"id":"deep-learning","displayTitle":"Deep Learning","__typename":"Tag"},"$Post:2f0a0c6472b5.previewContent":{"subtitle":"I started working on a NLP related project with  twitter data and one of the project goals included sentiment classification for each…","__typename":"PreviewContent"},"$ROOT_QUERY.notificationsConnection({})":{"notifications":[],"pagingInfo":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo","typename":"Paging"},"__typename":"NotificationsConnection"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo":{"next":null,"__typename":"Paging"},"$ROOT_QUERY.notificationStatus":{"unreadNotificationCount":0,"__typename":"NotificationStatus"}}</script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/manifest.61207c90.js"></script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/vendors_main.072bf65d.chunk.js"></script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/main.1689938d.chunk.js"></script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/vendors_screen.landingpages.trumpland_screen.post_screen.post.amp_screen.post.series_screen.profile__b319665e.f2be28a6.chunk.js"></script>
<script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/screen.post_screen.post.amp_screen.post.series_screen.profile_screen.sequence.library_screen.sequenc_036c6b37.cfefaf3d.chunk.js"></script>
<script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/screen.landingpages.trumpland_screen.post_screen.post.amp_screen.post.series_screen.profile_screen.s_5e114ebe.6d4cee8d.chunk.js"></script>
<script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/screen.post_screen.post.amp_screen.sequence.post.36538452.chunk.js"></script>
<script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/screen.post.7f77f5ef.chunk.js"></script><script>window.main();</script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/p.js" async="" id="parsely-cf"></script><script src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/16180790160.js" async=""></script><iframe src="./Sentiment analysis for text with Deep Learning - Towards Data Science_files/a16180790160.html" hidden="" aria-hidden="true" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe></body></html>